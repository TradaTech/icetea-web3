{"version":3,"sources":["webpack://IceTeaWeb3/webpack/universalModuleDefinition","webpack://IceTeaWeb3/webpack/bootstrap","webpack://IceTeaWeb3/./src/contract/Contract.js","webpack://IceTeaWeb3/./src/index.js","webpack://IceTeaWeb3/./src/providers/BaseProvider.js","webpack://IceTeaWeb3/./src/providers/HttpProvider.js","webpack://IceTeaWeb3/./src/providers/WebSocketProvider.js","webpack://IceTeaWeb3/./src/utils.js","webpack://IceTeaWeb3/external \"@babel/polyfill\"","webpack://IceTeaWeb3/external \"icetea-common\"","webpack://IceTeaWeb3/external \"node-fetch\"","webpack://IceTeaWeb3/external \"safe-buffer\"","webpack://IceTeaWeb3/external \"websocket\"","webpack://IceTeaWeb3/external \"websocket-as-promised\""],"names":["require","ecc","TxOp","_serializeData","address","method","privateKey","params","options","formData","txData","op","CALL_CONTRACT","name","from","toPublicKey","to","value","fee","data","Contract","tweb3","methods","Proxy","get","obj","call","callReadonlyContractMethod","sendAsync","tx","sendTransactionAsync","sendSync","sendTransactionSync","sendCommit","sendTransactionCommit","set","Error","module","exports","signTxData","ContractMode","utils","switchEncoding","decodeTX","decodeEventData","decodeTags","decodeTxResult","HttpProvider","WebSocketProvider","IceTeaWeb3","endpoint","isWebSocket","startsWith","rpc","subscriptions","countSubscribeEvent","close","query","hash","then","eventName","emitter","conditions","Object","keys","reduce","arr","key","push","join","searchTransactions","contractAddr","send","contract","callback","systemEvent","isSystemEvent","nonSystemEventName","space","indexOf","i","result","id","subscribeMethod","registerEventListener","message","jsonMsg","JSON","parse","events","forEach","event","res","jsonrpc","stringify","subscriptionId","Promise","reject","mode","src","getTransaction","tx_result","code","err","log","assign","height","DEPLOY_CONTRACT","JS_DECORATED","JS_RAW","encodeTX","tryParseJson","BaseProvider","k","v","String","_call","resp","error","path","r","response","info","fetch","json","Date","now","sanitizeParams","headers","body","W3CWebSocket","w3cwebsocket","WebSocketAsPromised","createWebSocket","url","packMessage","unpackMessage","attachRequestId","requestId","extractRequestId","wsp","addListener","isOpened","open","sendRequest","Buffer","codec","replaceAll","text","search","replacement","split","p","e","tryStringifyJson","enc","encode","toString","toBuffer","str","decode","keepEvents","EMPTY_RESULT","b64Tags","TxResult","tags","deliver_tx","length","t","EventNames","parts","eventData","prefix","substr"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"IceTeaWeb3\"] = factory();\n\telse\n\t\troot[\"IceTeaWeb3\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const { ecc, TxOp } = require('icetea-common')\n\nfunction _serializeData (address, method, privateKey, params = [], options = {}) {\n  var formData = {}\n  var txData = {\n    op: TxOp.CALL_CONTRACT,\n    name: method,\n    params: params\n  }\n  formData.from = ecc.toPublicKey(privateKey)\n  formData.to = address\n  formData.value = options.value || 0\n  formData.fee = options.fee || 0\n  formData.data = txData\n  return formData\n}\n\nclass Contract {\n  constructor (tweb3, address, privateKey) {\n    // this.iweb3 = iweb3;\n    // this.address = address;\n    this.methods = new Proxy({}, {\n      get: function (obj, method) {\n        return {\n          call: function (params = [], options = {}) {\n            return tweb3.callReadonlyContractMethod(address, method, params, options)\n          },\n          sendAsync: function (params, options) {\n            var tx = _serializeData(address, method, privateKey, params, options)\n            return tweb3.sendTransactionAsync(tx, privateKey)\n          },\n          sendSync: function (params, options) {\n            var tx = _serializeData(address, method, privateKey, params, options)\n            return tweb3.sendTransactionSync(tx, privateKey)\n          },\n          sendCommit: function (params, options) {\n            var tx = _serializeData(address, method, privateKey, params, options)\n            return tweb3.sendTransactionCommit(tx, privateKey)\n          }\n        }\n      },\n      set: function () {\n        throw new Error('Cannot change methods.')\n      }\n    })\n  }\n}\n\nmodule.exports = Contract\n\n","const { signTxData } = require('icetea-common').ecc\nconst { ecc, TxOp, ContractMode } = require('icetea-common')\nconst utils = require('./utils')\nconst { switchEncoding, decodeTX ,decodeEventData, decodeTags, decodeTxResult} = require('./utils')\nconst Contract = require('./contract/Contract')\nconst HttpProvider = require('./providers/HttpProvider')\nconst WebSocketProvider = require('./providers/WebSocketProvider')\n\nexports.utils = utils\n\n/**\n * The IceTea web client.\n */\nexports.IceTeaWeb3 = class IceTeaWeb3 {\n  /**\n   * Initialize the IceTeaWeb3 instance.\n   * @param {string} endpoint tendermint endpoint, e.g. http://localhost:26657\n   */\n  constructor (endpoint, options) {\n    this.isWebSocket = !!(endpoint.startsWith('ws://') || endpoint.startsWith('wss://'))\n    if (this.isWebSocket) {\n      this.rpc = new WebSocketProvider(endpoint, options)\n    } else {\n      this.rpc = new HttpProvider(endpoint)\n    }\n\n    this.utils = {\n      decodeEventData,\n      decodeTags,\n      decodeTxResult\n    }\n    this.subscriptions = {}\n    this.countSubscribeEvent = 0\n  }\n\n  close () {\n    if (this.isWebSocket) {\n      this.rpc.close()\n    }\n  }\n\n  /**\n   * Get account balance.\n   * @param {string} address address of the account.\n   * @returns {number} account balance.\n   */\n  getBalance (address) {\n    return this.rpc.query('balance', address)\n  }\n\n  /**\n   * Get a single block.\n   * @param {*} options example {height: 10}, skip to get latest block.\n   * @returns the tendermint block.\n   */\n  getBlock (options) {\n    return this.rpc.call('block', options)\n  }\n\n  /**\n   * Get a list of blocks.\n   * @param {*} options optional, e.g. {minHeight: 0, maxHeight: 10}\n   * @returns {Array} an array of tendermint blocks\n   */\n  getBlocks (options) {\n    return this.rpc.call('blockchain', options)\n  }\n\n  /**\n   * Get a single transaction.\n   * @param {string} hash required, hex string without '0x'.\n   * @param {*} options optional, e.g. {prove: true} to request proof.\n   * @return {*} the tendermint transaction.\n   */\n  getTransaction (hash, options) {\n    if (!hash) {\n      throw new Error('hash is required')\n    }\n    return this.rpc.call('tx', { hash: switchEncoding(hash, 'hex', 'base64'), ...options })\n      .then(decodeTxResult)\n  }\n\n  /**\n   * Search for transactions met the query specified.\n   * @param {string} query required, query based on tendermint indexed tags, e.g. \"tx.height>0\".\n   * @param {*} options additional options, e.g. {prove: true, page: 2, per_page: 20}\n   * @returns {Array} Array of tendermint transactions.\n   */\n  searchTransactions (query, options) {\n    if (!query) {\n      throw new Error('query is required, example \"tx.height>0\"')\n    }\n    return this.rpc.call('tx_search', { query, ...options })\n  }\n\n  /**\n   * Search for events emit by contracts.\n   * @param {string} eventName the event name, e.g. \"Transferred\"\n   * @param {string} emitter optional, the contract address, or \"system\"\n   * @param {*} conditions required, string or object literal.\n   * string example: \"tx.height>0 AND someIndexedField CONTAINS 'kkk'\".\n   * Object example: {fromBlock: 0, toBlock: 100, someIndexedField: \"xxx\"}.\n   * Note that conditions are combined using AND, no support for OR.\n   * @param {*} options additional options, e.g. {prove: true, page: 2, per_page: 20}\n   * @returns {Array} Array of tendermint transactions containing the event.\n   */\n  getPastEvents (eventName, emitter, conditions = {}, options) {\n    let query = ''\n    if (typeof conditions === 'string') {\n      query = conditions\n    } else {\n      if (!emitter) {\n        emitter = '.'\n      } else {\n        emitter = '|' + emitter + '.'\n      }\n      query = Object.keys(conditions).reduce((arr, key) => {\n        const value = conditions[key]\n        if (key === 'fromBlock') {\n          arr.push(`tx.height>${value - 1}`)\n        } else if (key === 'toBlock') {\n          arr.push(`tx.height<${value + 1}`)\n        } else {\n          arr.push(`${key}=${value}`)\n        }\n        return arr\n      }, [`EventNames CONTAINS '${emitter}${eventName}|'`]).join(' AND ')\n    }\n\n    return this.searchTransactions(query, options)\n  }\n\n  /**\n   * @return {string[]} Get all deployed smart contracts.\n   */\n  getContracts () {\n    return this.rpc.query('contracts')\n  }\n\n  /**\n   * Get contract metadata.\n   * @param {string} contractAddr the contract address.\n   * @returns {string[]} methods and fields array.\n   */\n  getMetadata (contractAddr) {\n    return this.rpc.query('metadata', contractAddr)\n  }\n  \n  /**\n   * Get account info.\n   * @param {string} contractAddr  the contract address.\n   * @returns {{balance: number, code: string | Buffer, mode: number, deployedBy: string, system: boolean}} Contract metadata.\n   */\n  getAccountInfo (contractAddr) {\n    return this.rpc.query('account_info', contractAddr)\n  }\n\n  /**\n   * @private\n   */\n  getDebugState () {\n    return this.rpc.query('state')\n  }\n\n  /**\n   * Send a transaction and return immediately.\n   * @param {{from: string, to: string, value: number, fee: number, data: Object}} tx the transaction object.\n   * @param {string} privateKey private key used to sign\n   */\n  sendTransactionAsync (tx, privateKey) {\n    return this.rpc.send('broadcast_tx_async', signTxData(tx, privateKey))\n  }\n\n  /**\n   * Send a transaction and wait until it reach mempool.\n   * @param {{from: string, to: string, value: number, fee: number, data: Object}} tx the transaction object.\n   * @param {string} privateKey private key used to sign\n   */\n  sendTransactionSync (tx, privateKey) {\n    return this.rpc.send('broadcast_tx_sync', signTxData(tx, privateKey))\n  }\n\n  /**\n   * Send a transaction and wait until it is included in a block.\n   * @param {{from: string, to: string, value: number, fee: number, data: Object}} tx the transaction object.\n   * @param {string} privateKey private key used to sign\n   */\n  sendTransactionCommit (tx, privateKey) {\n    return this.rpc.send('broadcast_tx_commit', signTxData(tx, privateKey))\n      .then(decodeTxResult)\n  }\n\n  /**\n   * Call a readonly (@view) contract method or field.\n   * @param {string} contract required, the contract address.\n   * @param {string} method required, method or field name.\n   * @param {Array} params method params, if any.\n   * @param {*} options optional options, e.g. {from: 'xxx'}\n   */\n  callReadonlyContractMethod (contract, method, params = [], options = {}) {\n    return this.rpc.query('invokeView', { address: contract, name: method, params, options })\n  }\n\n  /**\n   * Call a pure (@pure) contract method or field.\n   * @param {string} contract required, the contract address.\n   * @param {string} method required, method or field name.\n   * @param {Array} params method params, if any.\n   * @param {*} options optional options, e.g. {from: 'xxx'}\n   */\n  callPureContractMethod (contract, method, params = [], options = {}) {\n    return this.rpc.query('invokePure', { address: contract, name: method, params, options })\n  }\n\n  // shorthand for transfer, deploy, write, read contract goes here\n  /**\n     * Subscribes by event (for WebSocket only)\n     *\n     * @method subscribe\n     *\n     * @param {MessageEvent} EventName\n     */\n  subscribe (eventName, conditions = {}, callback) {\n    if (!this.isWebSocket) throw new Error('subscribe for WebSocket only')\n    let systemEvent = ['NewBlock', 'NewBlockHeader', 'Tx', 'RoundState', 'NewRound', 'CompleteProposal', 'Vote', 'ValidatorSetUpdates', 'ProposalString']\n    let isSystemEvent = true\n    let nonSystemEventName\n    let space = ''\n\n    if (systemEvent.indexOf(eventName) < 0) {\n      isSystemEvent = false\n      nonSystemEventName = eventName\n      this.countSubscribeEvent += 1\n      eventName = 'Tx'\n    }\n\n    for (var i = 0; i < this.countSubscribeEvent; i++) {\n      space = space + ' '\n    }\n\n    var query = ''\n    if (typeof conditions === 'string') {\n      query = conditions\n    } else {\n      if (typeof conditions === 'function' && typeof callback === 'undefined') {\n        callback = conditions\n        conditions = {}\n      }\n      query = Object.keys(conditions).reduce((arr, key) => {\n        const value = conditions[key]\n        if (key === 'fromBlock') {\n          arr.push(`tx.height>${value - 1}`)\n        } else if (key === 'toBlock') {\n          arr.push(`tx.height<${value + 1}`)\n        } else {\n          arr.push(`${key}=${value}`)\n        }\n        return arr\n      }, [`tm.event = ${space}'${eventName}'`]).join(' AND ')\n    }\n\n    return this.rpc.call('subscribe', { 'query': query }).then((result) => {\n      this.subscriptions[result.id] = {\n        id: result.id,\n        subscribeMethod: nonSystemEventName || eventName,\n        query: query\n      }\n      // console.log('this.subscriptions',this.subscriptions);\n      this.rpc.registerEventListener('onMessage', (message) => {\n        let jsonMsg = JSON.parse(message)\n        if (result.id && jsonMsg.id.indexOf(result.id) >= 0) {\n          if (isSystemEvent) {\n            return callback(message)\n          } else {\n            let events = decodeEventData(jsonMsg.result)\n            events.forEach(event => {\n              if (event.eventName && nonSystemEventName === event.eventName) {\n                let res = {}\n                res.jsonrpc = jsonMsg.jsonrpc\n                res.id = jsonMsg.id\n                res.result = event\n                res.result.query = this.subscriptions[result.id].query\n                return callback(JSON.stringify(res), null, 2)\n              }\n            })\n          }\n        }\n      })\n\n      return result\n    })\n  }\n  /**\n   * Unsubscribes by event (for WebSocket only)\n   *\n   * @method unsubscribe\n   *\n   * @param {SubscriptionId} subscriptionId\n   */\n  unsubscribe (subscriptionId) {\n    if (!this.isWebSocket) throw new Error('unsubscribe for WebSocket only')\n    if (typeof this.subscriptions[subscriptionId] !== 'undefined') {\n      return this.rpc.call('unsubscribe', { 'query': this.subscriptions[subscriptionId].query }).then((res) => {\n        delete this.subscriptions[subscriptionId]\n        return res\n      })\n    }\n    return Promise.reject(new Error(`Error: Subscription with ID ${subscriptionId} does not exist.`))\n  }\n\n  onMessage (callback) {\n    if (!this.isWebSocket) throw new Error('onMessage for WebSocket only')\n    this.rpc.registerEventListener('onMessage', callback)\n  }\n\n  onResponse (callback) {\n    if (!this.isWebSocket) throw new Error('onResponse for WebSocket only')\n    this.rpc.registerEventListener('onResponse', callback)\n  }\n\n  onError (callback) {\n    if (!this.isWebSocket) throw new Error('onError for WebSocket only')\n    this.rpc.registerEventListener('onError', callback)\n  }\n\n  onClose (callback) {\n    if (!this.isWebSocket) throw new Error('onClose for WebSocket only')\n    this.rpc.registerEventListener('onClose', callback)\n  }\n\n  contract (address, privateKey) {\n    return new Contract(this, address, privateKey)\n  }\n\n  async deploy (mode, src, privateKey, params = [], options = {}) {\n    let tx = this._serializeData(mode, src, privateKey, params, options)\n    let res = await this.sendTransactionCommit(tx, privateKey)\n    return this.getTransaction(res.hash).then(result => {\n      if (result.tx_result.code) {\n        const err = new Error(result.tx_result.log)\n        Object.assign(err, result)\n        throw err\n      }\n      const data = decodeTX(result.tx)\n      // console.log(\"data1\",data);\n      return {\n        hash: result.hash,\n        height: result.height,\n        address: result.tx_result.data,\n        data: {\n          from: data.from,\n          to: result.tx_result.data,\n          value: data.value,\n          fee: data.fee\n        }\n      }\n    })\n  }\n\n  _serializeData (mode, src, privateKey, params, options) {\n    var formData = {}\n    var txData = {\n      op: TxOp.DEPLOY_CONTRACT,\n      mode: mode,\n      params: params\n    }\n    if (mode === ContractMode.JS_DECORATED || mode === ContractMode.JS_RAW) {\n      txData.src = switchEncoding(src, 'utf8', 'base64')\n    } else {\n      txData.src = src\n    }\n    formData.from = ecc.toPublicKey(privateKey)\n    formData.value = options.value || 0\n    formData.fee = options.fee || 0\n    formData.data = txData\n    return formData\n  }\n}\n","const { switchEncoding, encodeTX, tryParseJson } = require('../utils')\n\nclass BaseProvider {\n  sanitizeParams (params) {\n    params = params || {}\n    Object.keys(params).forEach(k => {\n      let v = params[k]\n      if (typeof v === 'number') {\n        params[k] = String(v)\n      }\n    })\n    return params\n  }\n\n  _call (method, params) {}\n\n  // call a jsonrpc, normally to query blockchain (block, tx, validator, consensus, etc.) data\n  call (method, params) {\n    return this._call(method, params).then(resp => {\n      if (resp.error) {\n        const err = new Error(resp.error.message)\n        Object.assign(err, resp.error)\n        throw err\n      }\n      if (resp.id) resp.result.id = resp.id\n      return resp.result\n    })\n  }\n\n  // query application state (read)\n  query (path, data, options) {\n    const params = { path, ...options }\n    if (data) {\n      if (typeof data !== 'string') {\n        data = JSON.stringify(data)\n      }\n      params.data = switchEncoding(data, 'utf8', 'hex')\n    }\n\n    return this._call('abci_query', params).then(resp => {\n      if (resp.error) {\n        const err = new Error(resp.error.message)\n        Object.assign(err, resp.error)\n        throw err\n      }\n\n      // decode query data embeded in info\n      let r = resp.result\n      if (r && r.response && r.response.info) {\n        r = tryParseJson(r.response.info)\n      }\n      return r\n    })\n  }\n\n  // send a transaction (write)\n  send (method, tx) {\n    return this.call(method, {\n      // for jsonrpc, encode in 'base64'\n      // for query string (REST), encode in 'hex' (or 'utf8' inside quotes)\n      tx: encodeTX(tx, 'base64')\n    }).then(result => {\n      if (result.code) {\n        const err = new Error(result.log)\n        Object.assign(err, result)\n        throw err\n      }\n\n      return result\n    })\n  }\n}\n\nmodule.exports = BaseProvider\n","const fetch = require('node-fetch')\nconst BaseProvider = require('./BaseProvider')\n\nclass HttpProvider extends BaseProvider {\n  constructor (endpoint) {\n    super()\n    this.endpoint = endpoint\n  }\n\n  _call (method, params) {\n    const json = {\n      jsonrpc: '2.0',\n      id: Date.now(),\n      method,\n      params: this.sanitizeParams(params)\n    }\n\n    return fetch(this.endpoint, {\n      method: 'POST',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json; charset=utf-8'\n      },\n      body: JSON.stringify(json)\n    })\n      .then(resp => resp.json())\n  }\n\n  sanitizeParams (params) {\n    return super.sanitizeParams(params)\n  }\n}\n\nmodule.exports = HttpProvider\n","const BaseProvider = require('./BaseProvider')\nconst W3CWebSocket = require('websocket').w3cwebsocket\nconst WebSocketAsPromised = require('websocket-as-promised')\n\nclass WebSocketProvider extends BaseProvider {\n  constructor (endpoint, options) {\n    super()\n    this.endpoint = endpoint\n    this.options = options || {\n      createWebSocket: url => new W3CWebSocket(url),\n      packMessage: data => JSON.stringify(data),\n      unpackMessage: message => JSON.parse(message),\n      attachRequestId: (data, requestId) => Object.assign({ id: requestId }, data),\n      extractRequestId: data => data.id\n      // timeout: 10000,\n    }\n    this.wsp = new WebSocketAsPromised(this.endpoint, this.options)\n  }\n\n  close () {\n    this.wsp.close()\n  }\n\n  registerEventListener (event, callback) {\n    this.wsp[event].addListener(callback)\n  }\n\n  async _call (method, params) {\n    const json = {\n      jsonrpc: '2.0',\n      method,\n      params: this.sanitizeParams(params)\n    }\n\n    if (!this.wsp.isOpened) {\n      await this.wsp.open()\n    }\n\n    return this.wsp.sendRequest(json)\n  }\n\n  sanitizeParams (params) {\n    return super.sanitizeParams(params)\n  }\n}\n\nmodule.exports = WebSocketProvider\n","const Buffer = require('safe-buffer').Buffer\nconst { codec } = require('icetea-common')\n\nexports.replaceAll = (text, search, replacement) => {\n  return text.split(search).join(replacement)\n}\n\nexports.tryParseJson = p => {\n  try {\n    return JSON.parse(p)\n  } catch (e) {\n    // console.log(\"WARN: \", e);\n    return p\n  }\n}\n\nexports.tryStringifyJson = p => {\n  try {\n    return JSON.stringify(p)\n  } catch (e) {\n    // console.log(\"WARN: \", e);\n    return p\n  }\n}\n\nexports.encodeTX = (data, enc = 'base64') => {\n  return codec.encode(data).toString(enc)\n}\n\nexports.toBuffer = (text, enc) => {\n  return Buffer.from(text, enc)\n}\n\nexports.switchEncoding = (str, from, to) => {\n  return Buffer.from(str, from).toString(to)\n}\n\nexports.decodeTX = (data, enc = 'base64') => {\n  return codec.decode(exports.toBuffer(data, enc))\n}\n\nexports.decodeTags = (tx, keepEvents = false) => {\n  const EMPTY_RESULT = {}\n  let b64Tags = tx\n\n  if (tx.data && tx.data.value && tx.data.value.TxResult.result.tags) {\n    b64Tags = tx.data.value.TxResult.result.tags // For subscribe\n  } else if (tx.tx_result && tx.tx_result.tags) {\n    b64Tags = tx.tx_result.tags\n  } else if (tx.deliver_tx && tx.deliver_tx.tags) {\n    b64Tags = tx.deliver_tx.tags\n  }\n  if (!b64Tags.length) {\n    return EMPTY_RESULT\n  }\n\n  const tags = {}\n  // decode tags\n  b64Tags.forEach(t => {\n    const key = this.switchEncoding(t.key, 'base64', 'utf8')\n    const value = this.switchEncoding(t.value, 'base64', 'utf8')\n    tags[key] = this.tryParseJson(value)\n  })\n\n  if (!keepEvents && tags.EventNames) {\n    // remove event-related tags\n    const events = tags.EventNames.split('|')\n    events.forEach(e => {\n      if (e) {\n        const eventName = e.split('.')[1]\n        Object.keys(tags).forEach(key => {\n          if (key.indexOf(eventName) === 0) {\n            delete tags[key]\n          }\n        })\n        delete tags[e]\n      }\n    })\n    delete tags.EventNames\n  }\n\n  return tags\n}\n\nexports.decodeTxResult = (result) => {\n  if (!result) return result\n  const name = result.tx_result ? 'tx_result' : 'deliver_tx'\n\n  if (result[name] && result[name].data) {\n    result[name].data = this.tryParseJson(this.switchEncoding(result[name].data, 'base64', 'utf8'))\n  }\n\n  return result\n}\n\nexports.decodeEventData = (tx) => {\n  const EMPTY_RESULT = []\n\n  const tags = this.decodeTags(tx, true)\n\n  if (!tags.EventNames) {\n    return EMPTY_RESULT\n  }\n\n  const events = tags.EventNames.split('|')\n  if (!events.length) {\n    return EMPTY_RESULT\n  }\n\n  const result = events.reduce((r, e) => {\n    if (e) {\n      const parts = e.split('.')\n      const emitter = parts[0]\n      const eventName = parts[1]\n      const eventData = Object.keys(tags).reduce((data, key) => {\n        const prefix = eventName + '.'\n        if (key.startsWith(prefix)) {\n          const name = key.substr(prefix.length)\n          const value = tags[key]\n          data[name] = value\n        } else if (key === eventName) {\n          Object.assign(data, tags[key])\n        }\n        return data\n      }, {})\n      r.push({ emitter, eventName, eventData })\n    }\n    return r\n  }, [])\n\n  return result\n}","module.exports = require(\"@babel/polyfill\");","module.exports = require(\"icetea-common\");","module.exports = require(\"node-fetch\");","module.exports = require(\"safe-buffer\");","module.exports = require(\"websocket\");","module.exports = require(\"websocket-as-promised\");"],"sourceRoot":""}